<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script>
        const CELL_SIZE = 4;

        $(document).ready(function () {

            function clearCanvas(cxt, canvasWidth, canvasHeight) {
                cxt.clearRect(0, 0, canvasWidth, canvasHeight);
                cxt.fillStyle = "#eee";
                cxt.fillRect(0, 0, canvasWidth, canvasHeight);
            }

            let mousePress = false;
            const originalCanvas = $("#original");
            const originalContext = originalCanvas.get(0).getContext("2d");
            const copyCanvas = $("#copy");
            const copyContext = copyCanvas.get(0).getContext("2d");
            clearCanvas(originalContext, originalCanvas.width(), originalCanvas.height());

            originalContext.fillStyle = "#000";
            originalContext.font = "125px Arial";
            originalContext.textBaseline = 'middle';
            originalContext.textAlign = 'center';
            originalContext.fillText(String.fromCharCode(parseInt("099C", 16)), originalCanvas.width() / 2, originalCanvas.height() / 2);
            // http://jrgraphix.net/r/Unicode/0980-09FF

            clearCanvas(copyContext, copyCanvas.width(), copyCanvas.height());

            let curves = [];
            let points = [];

            $(originalCanvas).mousedown(function (e) {
                mousePress = true;
                points = [];
                points.push({x: e.pageX, y: e.pageY})
            });

            $(originalCanvas).mouseup(function (e) {
                mousePress = false;
                curves.push(points);
                let str = "";
                console.log(points);
            });

            $(originalCanvas).mousemove(function (e) {
                if (mousePress) {
                    points.push({x: e.pageX, y: e.pageY});

                    originalContext.fillStyle = "#f00";
                    originalContext.fillRect(e.pageX, e.pageY, 1, 1);
                }
            });

            $("#clearButton").click(function (e) {
                curves = [];
                clearCanvas(originalContext, originalCanvas.width(), originalCanvas.height());
                clearCanvas(copyContext, copyCanvas.width(), copyCanvas.height());
            });

            $("#printButton").click(function (e) {
                clearCanvas(copyContext, copyCanvas.width(), copyCanvas.height());
                copyContext.fillStyle = "#000";
                copyContext.lineWidth=5;
                copyContext.strokeStyle="red";

/*
                curves = [
                    [{"x":60,"y":76},{"x":157,"y":76}],
                    [{"x":118,"y":73},{"x":118,"y":74},{"x":117,"y":75},{"x":116,"y":76},{"x":115,"y":78},{"x":114,"y":79},{"x":112,"y":81},{"x":112,"y":81},{"x":110,"y":83},{"x":109,"y":84},{"x":108,"y":84},{"x":108,"y":85},{"x":107,"y":86},{"x":106,"y":87},{"x":105,"y":88},{"x":105,"y":89},{"x":104,"y":90},{"x":104,"y":91},{"x":104,"y":91},{"x":103,"y":92},{"x":103,"y":92},{"x":102,"y":92},{"x":102,"y":93},{"x":101,"y":94},{"x":100,"y":95},{"x":99,"y":96},{"x":99,"y":96},{"x":99,"y":96},{"x":99,"y":96},{"x":98,"y":97},{"x":98,"y":97},{"x":97,"y":98},{"x":96,"y":99},{"x":96,"y":99},{"x":96,"y":100},{"x":96,"y":100},{"x":95,"y":100},{"x":95,"y":100},{"x":95,"y":101},{"x":94,"y":101},{"x":94,"y":102},{"x":94,"y":102},{"x":94,"y":102},{"x":94,"y":103},{"x":94,"y":102}],
                    [{"x":94,"y":102},{"x":94,"y":103},{"x":94,"y":103},{"x":94,"y":103},{"x":94,"y":103},{"x":94,"y":104},{"x":94,"y":104},{"x":95,"y":105},{"x":95,"y":105},{"x":96,"y":106},{"x":96,"y":107},{"x":97,"y":108},{"x":97,"y":108},{"x":98,"y":109},{"x":98,"y":109},{"x":98,"y":109},{"x":99,"y":109},{"x":99,"y":110},{"x":100,"y":110},{"x":100,"y":111},{"x":101,"y":111},{"x":101,"y":112},{"x":102,"y":112},{"x":102,"y":112},{"x":103,"y":113},{"x":103,"y":113},{"x":103,"y":113}],
                    [{"x":103,"y":113},{"x":121,"y":112}],
                    [{"x":121,"y":112},{"x":122,"y":129}],
                    [{"x":123,"y":129},{"x":123,"y":129},{"x":123,"y":129},{"x":123,"y":129},{"x":122,"y":130},{"x":121,"y":130},{"x":120,"y":131},{"x":119,"y":132},{"x":118,"y":132},{"x":118,"y":133},{"x":117,"y":133},{"x":116,"y":134},{"x":115,"y":134},{"x":114,"y":135},{"x":114,"y":136},{"x":113,"y":136},{"x":113,"y":136},{"x":112,"y":137},{"x":112,"y":137},{"x":111,"y":137},{"x":111,"y":138}],
                    [{"x":111,"y":138},{"x":92,"y":137}],
                    [{"x":92,"y":137},{"x":91,"y":137},{"x":91,"y":137},{"x":90,"y":137},{"x":89,"y":136},{"x":88,"y":136},{"x":87,"y":135},{"x":85,"y":134},{"x":84,"y":133},{"x":83,"y":133},{"x":82,"y":132},{"x":82,"y":132},{"x":81,"y":132},{"x":81,"y":132},{"x":81,"y":132},{"x":80,"y":131},{"x":79,"y":131},{"x":79,"y":130},{"x":78,"y":130},{"x":78,"y":130},{"x":78,"y":130},{"x":78,"y":129}],
                    [{"x":78,"y":129},{"x":78,"y":129},{"x":78,"y":128},{"x":77,"y":128},{"x":76,"y":126},{"x":76,"y":125},{"x":75,"y":123},{"x":74,"y":122},{"x":74,"y":121},{"x":74,"y":120},{"x":73,"y":119},{"x":73,"y":119},{"x":73,"y":118},{"x":73,"y":118},{"x":73,"y":118},{"x":73,"y":118},{"x":72,"y":117},{"x":71,"y":116},{"x":71,"y":114},{"x":70,"y":113},{"x":70,"y":112},{"x":69,"y":111},{"x":69,"y":110},{"x":69,"y":109},{"x":69,"y":108},{"x":69,"y":108},{"x":69,"y":107},{"x":69,"y":107},{"x":69,"y":106},{"x":69,"y":106},{"x":69,"y":106},{"x":69,"y":105},{"x":69,"y":105},{"x":69,"y":104},{"x":69,"y":104}],
                    [{"x":117,"y":78},{"x":117,"y":78},{"x":117,"y":79},{"x":117,"y":79},{"x":117,"y":80},{"x":118,"y":81},{"x":118,"y":81},{"x":119,"y":82},{"x":119,"y":83},{"x":119,"y":83},{"x":120,"y":84},{"x":120,"y":84},{"x":120,"y":85},{"x":121,"y":86},{"x":121,"y":87},{"x":121,"y":87},{"x":122,"y":88},{"x":123,"y":89},{"x":123,"y":90},{"x":123,"y":90},{"x":124,"y":91},{"x":124,"y":91},{"x":124,"y":91},{"x":124,"y":91},{"x":124,"y":92},{"x":124,"y":92},{"x":124,"y":92}],
                    [{"x":124,"y":92},{"x":124,"y":92},{"x":125,"y":92},{"x":125,"y":92},{"x":126,"y":93},{"x":126,"y":93},{"x":127,"y":93},{"x":127,"y":94},{"x":128,"y":94},{"x":129,"y":95},{"x":130,"y":95},{"x":130,"y":95},{"x":131,"y":96},{"x":132,"y":97},{"x":132,"y":97},{"x":133,"y":97},{"x":133,"y":98},{"x":134,"y":98},{"x":134,"y":99},{"x":135,"y":99},{"x":135,"y":99},{"x":136,"y":99},{"x":136,"y":100},{"x":136,"y":100},{"x":137,"y":100},{"x":137,"y":100}],
                    [{"x":137,"y":100},{"x":137,"y":100},{"x":138,"y":100},{"x":138,"y":100},{"x":140,"y":100},{"x":140,"y":100},{"x":141,"y":101},{"x":142,"y":101},{"x":142,"y":101},{"x":143,"y":101},{"x":143,"y":101},{"x":144,"y":101},{"x":144,"y":102},{"x":145,"y":102},{"x":145,"y":102},{"x":145,"y":102},{"x":146,"y":102},{"x":146,"y":102},{"x":147,"y":102},{"x":147,"y":102},{"x":148,"y":102},{"x":148,"y":103}],
                    [{"x":148,"y":103},{"x":148,"y":103},{"x":148,"y":104},{"x":148,"y":105},{"x":147,"y":106},{"x":147,"y":106},{"x":147,"y":107},{"x":147,"y":108},{"x":146,"y":108},{"x":146,"y":109},{"x":146,"y":109},{"x":146,"y":110},{"x":146,"y":110},{"x":146,"y":111},{"x":146,"y":112},{"x":146,"y":113},{"x":146,"y":114},{"x":145,"y":115},{"x":145,"y":116},{"x":145,"y":117},{"x":145,"y":118},{"x":145,"y":119},{"x":145,"y":119},{"x":145,"y":120},{"x":145,"y":120},{"x":145,"y":120},{"x":145,"y":120}],
                    [{"x":145,"y":120},{"x":145,"y":121},{"x":145,"y":122},{"x":145,"y":122},{"x":145,"y":124},{"x":145,"y":126},{"x":144,"y":127},{"x":144,"y":129},{"x":144,"y":131},{"x":144,"y":132},{"x":144,"y":133},{"x":144,"y":134},{"x":143,"y":136},{"x":143,"y":137},{"x":143,"y":138},{"x":143,"y":139},{"x":143,"y":139},{"x":143,"y":140},{"x":143,"y":141},{"x":143,"y":142},{"x":143,"y":142},{"x":143,"y":142},{"x":143,"y":143},{"x":143,"y":143},{"x":143,"y":143},{"x":143,"y":144},{"x":143,"y":144},{"x":143,"y":144},{"x":143,"y":144},{"x":143,"y":145},{"x":143,"y":145},{"x":143,"y":145},{"x":143,"y":145},{"x":143,"y":146},{"x":143,"y":147},{"x":143,"y":148},{"x":143,"y":150},{"x":143,"y":150},{"x":144,"y":151},{"x":144,"y":151}]
                ];
*/

                for (let curveIndex in curves) {
                    let points = curves[curveIndex];
                    console.log(points);

                    if (points.length > 1) {
                        copyContext.beginPath();

                        if(points.length === 2) {
                            copyContext.moveTo(points[0].x, points[0].y);
                            copyContext.lineTo(points[1].x, points[1].y);
                        } else {
                            copyContext.moveTo(points[0].x, points[0].y);
                            let i = 1;
                            for (; i < points.length - 2; i ++) {
                                const xc = (points[i].x + points[i + 1].x) / 2;
                                const yc = (points[i].y + points[i + 1].y) / 2;
                                copyContext.quadraticCurveTo(points[i].x, points[i].y, xc, yc);
                            }
                            copyContext.quadraticCurveTo(points[i].x, points[i].y, points[i+1].x, points[i+1].y);
                        }
                        copyContext.stroke();

//                        copyContext.moveTo((points[0].x), points[0].y);
//                        for (let i = 1; i < points.length - 1; i++) {
//                            copyContext.lineTo(points[i].x, points[i].y);
//                            copyContext.stroke();
//                        }
                    }
                }

            });

        });
    </script>
</head>

<body>

<canvas id="original" width="200" height="200"></canvas>
<canvas id="copy" width="200" height="200"></canvas>
<button id="clearButton" name="clearButton" value="Clear">Clear</button>
<button id="printButton" name="printButton" value="printButton">Print</button>

<div id="points">

</div>

</body>

</html>